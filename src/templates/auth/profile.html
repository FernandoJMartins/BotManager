{% extends "base.html" %} {% block title %}Perfil - Telegram Bot Manager{%
endblock %} {% block content %}
<div class="row">
  <div class="col-md-8">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-user me-2"></i>
          Meu Perfil
        </h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <p><strong>Username:</strong> {{ current_user.username }}</p>
            <p><strong>Email:</strong> {{ current_user.email }}</p>
            <p>
              <strong>Membro desde:</strong> {{
              current_user.created_at.strftime('%d/%m/%Y') }}
            </p>
          </div>
          <div class="col-md-6">
            <p>
              <strong>Total de bots:</strong> {{ current_user.bots|length }}
            </p>
            <p>
              <strong>Bots ativos:</strong> {{
              current_user.get_active_bots_count() }}
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-credit-card me-2"></i>
          Configuração PushinPay
        </h5>
      </div>
      <div class="card-body">
        {% if current_user.pushinpay_token %}
        <div class="alert alert-success">
          <i class="fas fa-check-circle me-2"></i>
          Token PushinPay configurado
        </div>
        <button class="btn btn-outline-primary" onclick="toggleTokenForm()">
          <i class="fas fa-edit me-2"></i>
          Alterar Token
        </button>
        {% else %}
        <div class="alert alert-warning">
          <i class="fas fa-exclamation-triangle me-2"></i>
          Token PushinPay não configurado
        </div>
        {% endif %}

        <div
          id="tokenForm"
          {%
          if
          current_user.pushinpay_token
          %}style="display:none;"
          {%
          endif
          %}
        >
          <form
            method="POST"
            action="{{ url_for('auth.save_pushinpay_token') }}"
          >
            <div class="mb-3">
              <label for="token" class="form-label"
                >Token Bearer PushinPay:</label
              >
              <input
                type="text"
                class="form-control"
                id="token"
                name="token"
                placeholder="Bearer 11111|XXXXX"
                required
              />
              <small class="form-text text-muted">
                Obtenha seu token no painel da PushinPay
              </small>
            </div>
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-save me-2"></i>
              Salvar Token
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Informações adicionais -->
<div class="row mt-4">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-info-circle me-2"></i>
          Como Funciona o PushinPay
        </h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-4">
            <h6><i class="fas fa-key text-primary me-2"></i>Token Bearer</h6>
            <p>
              Configure seu token da PushinPay uma única vez. Este token será
              usado para gerar PIX automaticamente.
            </p>
          </div>
          <div class="col-md-4">
            <h6>
              <i class="fas fa-share-alt text-success me-2"></i>Split Automático
            </h6>
            <p>
              100% dos pagamentos vão direto para a conta configurada no sistema
              (taxa de R$ 0,70 por bot).
            </p>
          </div>
          <div class="col-md-4">
            <h6>
              <i class="fas fa-robot text-info me-2"></i>Ativação Automática
            </h6>
            <p>
              Após confirmação do pagamento, seus bots são ativados
              automaticamente e começam a funcionar 24/7.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  function toggleTokenForm() {
    const form = document.getElementById("tokenForm");
    if (form.style.display === "none") {
      form.style.display = "block";
    } else {
      form.style.display = "none";
    }
  }
</script>
{% endblock %}
