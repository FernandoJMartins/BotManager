<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Telegram Bot Manager{% endblock %}</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Paleta de cores profissional */
      :root {
        --primary-blue: #1e40af;
        --primary-blue-light: #3b82f6;
        --primary-blue-dark: #1e3a8a;
        --success-green: #059669;
        --success-green-light: #10b981;
        --warning-orange: #ea580c;
        --warning-orange-light: #f97316;
        --info-teal: #0891b2;
        --info-teal-light: #06b6d4;
        --dark-gray: #1f2937;
        --medium-gray: #6b7280;
        --light-gray: #f9fafb;
        --white: #ffffff;
        --sidebar-gradient: linear-gradient(
          135deg,
          var(--primary-blue) 0%,
          var(--primary-blue-dark) 50%,
          #312e81 100%
        );
        --shadow-light: 0 1px 3px 0 rgb(0 0 0 / 0.1),
          0 1px 2px -1px rgb(0 0 0 / 0.1);
        --shadow-medium: 0 4px 6px -1px rgb(0 0 0 / 0.1),
          0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-large: 0 10px 15px -3px rgb(0 0 0 / 0.1),
          0 4px 6px -4px rgb(0 0 0 / 0.1);
        --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1),
          0 8px 10px -6px rgb(0 0 0 / 0.1);
      }

      /* Reset e base */
      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, sans-serif;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        color: var(--dark-gray);
        line-height: 1.6;
      }

      /* Sidebar melhorada */
      .sidebar {
        min-height: 100vh;
        background: var(--sidebar-gradient);
        position: relative;
        overflow: hidden;
        box-shadow: var(--shadow-xl);
      }

      .sidebar::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="%23ffffff" fill-opacity="0.03"><circle cx="30" cy="30" r="2"/></g></svg>');
        pointer-events: none;
      }

      .sidebar .p-3 {
        position: relative;
        z-index: 2;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        margin-bottom: 1rem;
      }

      .sidebar h4 {
        color: white;
        font-weight: 700;
        font-size: 1.5rem;
        margin-bottom: 0;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .sidebar .nav {
        position: relative;
        z-index: 2;
      }

      .nav-link {
        color: rgba(255, 255, 255, 0.85) !important;
        transition: transform 0.2s ease, background-color 0.2s ease, color 0.2s ease;
        border-radius: 12px !important;
        margin-bottom: 0.5rem;
        padding: 0.875rem 1rem !important;
        font-weight: 500;
        position: relative;
        overflow: hidden;
        will-change: transform;
      }

      .nav-link::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.1),
          transparent
        );
        transition: left 0.3s ease;
      }

      .nav-link:hover::before {
        left: 100%;
      }

      .nav-link:hover,
      .nav-link.active {
        color: white !important;
        background: rgba(255, 255, 255, 0.15) !important;
        backdrop-filter: blur(10px);
        transform: translate3d(4px, 0, 0);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .nav-link i {
        width: 20px;
        text-align: center;
        margin-right: 12px;
        transition: transform 0.3s ease;
      }

      .nav-link:hover i {
        transform: scale(1.1);
      }

      /* Main content */
      main {
        background: transparent;
        min-height: 100vh;
      }

      /* Cards melhorados */
      .card {
        border: none;
        border-radius: 16px;
        box-shadow: var(--shadow-medium);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        background: white;
        overflow: hidden;
        position: relative;
        will-change: transform;
      }

      .card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(
          90deg,
          var(--primary-blue) 0%,
          var(--primary-blue-light) 50%,
          var(--info-teal) 100%
        );
        opacity: 0;
        transition: opacity 0.2s ease;
      }

      .card:hover {
        transform: translate3d(0, -4px, 0);
        box-shadow: var(--shadow-xl);
      }

      .card:hover::before {
        opacity: 1;
      }

      /* Stat cards */
      .stat-card {
        background: linear-gradient(
          135deg,
          var(--primary-blue) 0%,
          var(--primary-blue-light) 100%
        );
        color: white;
        border: none;
        position: relative;
        overflow: hidden;
      }

      .stat-card::after {
        content: "";
        position: absolute;
        top: -50%;
        right: -50%;
        width: 100%;
        height: 100%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        pointer-events: none;
      }

      .stat-card .card-body {
        position: relative;
        z-index: 2;
      }

      /* Status colors */
      .bot-status-running {
        color: var(--success-green);
        font-weight: 600;
      }

      .bot-status-stopped {
        color: #dc2626;
        font-weight: 600;
      }

      .bot-status-pending {
        color: var(--warning-orange);
        font-weight: 600;
      }

      /* Alerts melhorados */
      .alert {
        border: none;
        border-radius: 12px;
        padding: 1rem 1.5rem;
        margin-bottom: 1.5rem;
        font-weight: 500;
        box-shadow: var(--shadow-light);
        position: relative;
        overflow: hidden;
      }

      .alert::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 4px;
        height: 100%;
        background: currentColor;
        opacity: 0.7;
      }

      .alert-success {
        background: linear-gradient(135deg, #dcfdf7 0%, #a7f3d0 100%);
        color: var(--success-green);
        border-left: 4px solid var(--success-green);
      }

      .alert-danger {
        background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
        color: #dc2626;
        border-left: 4px solid #dc2626;
      }

      .alert-warning {
        background: linear-gradient(135deg, #fffbeb 0%, #fed7aa 100%);
        color: var(--warning-orange);
        border-left: 4px solid var(--warning-orange);
      }

      .alert-info {
        background: linear-gradient(135deg, #f0f9ff 0%, #bae6fd 100%);
        color: var(--info-teal);
        border-left: 4px solid var(--info-teal);
      }

      /* Botões melhorados */
      .btn {
        border-radius: 10px;
        font-weight: 600;
        padding: 0.75rem 1.5rem;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        border: none;
        position: relative;
        overflow: hidden;
        will-change: transform;
      }

      .btn::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: width 0.2s ease, height 0.2s ease;
      }

      .btn:hover::before {
        width: 200px;
        height: 200px;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--primary-blue) 0%,
          var(--primary-blue-light) 100%
        );
        box-shadow: 0 4px 14px 0 rgba(30, 64, 175, 0.3);
      }

      .btn-primary:hover {
        background: linear-gradient(
          135deg,
          var(--primary-blue-dark) 0%,
          var(--primary-blue) 100%
        );
        transform: translate3d(0, -1px, 0);
        box-shadow: 0 6px 20px 0 rgba(30, 64, 175, 0.4);
      }

      .btn-success {
        background: linear-gradient(
          135deg,
          var(--success-green) 0%,
          var(--success-green-light) 100%
        );
        box-shadow: 0 4px 14px 0 rgba(5, 150, 105, 0.3);
      }

      .btn-success:hover {
        transform: translate3d(0, -1px, 0);
        box-shadow: 0 6px 20px 0 rgba(5, 150, 105, 0.4);
      }

      .btn-warning {
        background: linear-gradient(
          135deg,
          var(--warning-orange) 0%,
          var(--warning-orange-light) 100%
        );
        box-shadow: 0 4px 14px 0 rgba(234, 88, 12, 0.3);
      }

      .btn-warning:hover {
        transform: translate3d(0, -1px, 0);
        box-shadow: 0 6px 20px 0 rgba(234, 88, 12, 0.4);
      }

      .btn-info {
        background: linear-gradient(
          135deg,
          var(--info-teal) 0%,
          var(--info-teal-light) 100%
        );
        box-shadow: 0 4px 14px 0 rgba(8, 145, 178, 0.3);
      }

      .btn-info:hover {
        transform: translate3d(0, -1px, 0);
        box-shadow: 0 6px 20px 0 rgba(8, 145, 178, 0.4);
      }

      /* Tabelas melhoradas */
      .table {
        border-collapse: separate;
        border-spacing: 0;
      }

      .table thead th {
        background: linear-gradient(135deg, var(--light-gray) 0%, #f1f5f9 100%);
        border: none;
        color: var(--dark-gray);
        font-weight: 600;
        padding: 1rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-size: 0.875rem;
      }

      .table tbody tr {
        transition: all 0.2s ease;
      }

      .table tbody tr:hover {
        background-color: #f8fafc;
        transform: scale(1.01);
      }

      .table tbody td {
        padding: 1rem;
        border-top: 1px solid #e2e8f0;
        vertical-align: middle;
      }

      /* Badges melhorados */
      .badge {
        border-radius: 8px;
        padding: 0.5rem 1rem;
        font-weight: 600;
        font-size: 0.875rem;
      }

      .badge.bg-success {
        background: linear-gradient(
          135deg,
          var(--success-green) 0%,
          var(--success-green-light) 100%
        ) !important;
      }

      .badge.bg-warning {
        background: linear-gradient(
          135deg,
          var(--warning-orange) 0%,
          var(--warning-orange-light) 100%
        ) !important;
      }

      .badge.bg-info {
        background: linear-gradient(
          135deg,
          var(--info-teal) 0%,
          var(--info-teal-light) 100%
        ) !important;
      }

      .badge.bg-primary {
        background: linear-gradient(
          135deg,
          var(--primary-blue) 0%,
          var(--primary-blue-light) 100%
        ) !important;
      }

      /* Responsividade melhorada */
      @media (max-width: 768px) {
        .sidebar {
          position: fixed;
          top: 0;
          left: -100%;
          width: 280px;
          z-index: 1050;
          transition: left 0.3s ease;
        }

        .sidebar.show {
          left: 0;
        }

        main {
          margin-left: 0 !important;
        }

        .mobile-menu-btn {
          position: fixed;
          top: 1rem;
          left: 1rem;
          z-index: 1051;
          background: var(--primary-blue);
          color: white;
          border: none;
          border-radius: 50%;
          width: 50px;
          height: 50px;
          box-shadow: var(--shadow-large);
        }
      }

      /* Animações otimizadas */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translate3d(0, 20px, 0);
        }
        to {
          opacity: 1;
          transform: translate3d(0, 0, 0);
        }
      }

      @keyframes slideInLeft {
        from {
          opacity: 0;
          transform: translate3d(-20px, 0, 0);
        }
        to {
          opacity: 1;
          transform: translate3d(0, 0, 0);
        }
      }

      .animate-fade-in {
        animation: fadeInUp 0.3s ease-out forwards;
        will-change: transform, opacity;
      }

      .animate-slide-in {
        animation: slideInLeft 0.3s ease-out forwards;
        will-change: transform, opacity;
      }

      /* Remove will-change após animação para liberar recursos */
      .animate-fade-in.animation-complete,
      .animate-slide-in.animation-complete {
        will-change: auto;
      }

      /* Scrollbar customizada */
      ::-webkit-scrollbar {
        width: 8px;
      }

      ::-webkit-scrollbar-track {
        background: #f1f5f9;
      }

      ::-webkit-scrollbar-thumb {
        background: linear-gradient(
          135deg,
          var(--primary-blue) 0%,
          var(--primary-blue-light) 100%
        );
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(
          135deg,
          var(--primary-blue-dark) 0%,
          var(--primary-blue) 100%
        );
      }

      /* Loading states otimizado */
      .loading {
        position: relative;
        overflow: hidden;
      }

      .loading::after {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.4),
          transparent
        );
        animation: loading 1s infinite;
        will-change: transform;
      }

      @keyframes loading {
        0% {
          transform: translate3d(-100%, 0, 0);
        }
        100% {
          transform: translate3d(100%, 0, 0);
        }
      }
    </style>
  </head>
  <body>
    <!-- Mobile menu button -->
    <button class="mobile-menu-btn d-md-none" onclick="toggleSidebar()">
      <i class="fas fa-bars"></i>
    </button>

    <div class="container-fluid">
      <div class="row">
        <!-- Sidebar -->
        <nav class="col-md-3 col-lg-2 sidebar px-0" id="sidebar">
          <div class="p-3">
            <h4 class="text-white">
              <i class="fas fa-robot me-2"></i>
              Bot Manager
            </h4>
          </div>
          <ul class="nav flex-column px-3">
            <li class="nav-item mb-2">
              <a class="nav-link" href="{{ url_for('main.dashboard') }}">
                <i class="fas fa-tachometer-alt"></i>
                Dashboard
              </a>
            </li>
            <li class="nav-item mb-2">
              <a class="nav-link" href="{{ url_for('bots.list_bots') }}">
                <i class="fas fa-robot"></i>
                Meus Bots
              </a>
            </li>
            <li class="nav-item mb-2">
              <a class="nav-link" href="{{ url_for('bots.create_bot') }}">
                <i class="fas fa-plus"></i>
                Novo Bot
              </a>
            </li>
            <li class="nav-item mb-2">
              <a class="nav-link" href="{{ url_for('auth.profile') }}">
                <i class="fas fa-user"></i>
                Perfil
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('auth.logout') }}">
                <i class="fas fa-sign-out-alt"></i>
                Sair
              </a>
            </li>
          </ul>
        </nav>

        <!-- Main content -->
        <main class="col-md-9 col-lg-10 px-4">
          <div class="py-4">
            <!-- Flash messages -->
            {% with messages = get_flashed_messages(with_categories=true) %} {%
            if messages %} {% for category, message in messages %}
            <div
              class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show animate-fade-in"
              role="alert"
            >
              <i
                class="fas fa-{{ 'exclamation-triangle' if category == 'warning' else 'check-circle' if category == 'success' else 'info-circle' if category == 'info' else 'times-circle' }} me-2"
              ></i>
              {{ message }}
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="alert"
              ></button>
            </div>
            {% endfor %} {% endif %} {% endwith %}

            <!-- Page content -->
            <div class="animate-fade-in">{% block content %}{% endblock %}</div>
          </div>
        </main>
      </div>
    </div>

    <!-- Overlay para mobile -->
    <div
      class="d-md-none position-fixed top-0 start-0 w-100 h-100 bg-dark opacity-50"
      id="sidebar-overlay"
      style="display: none; z-index: 1040"
      onclick="toggleSidebar()"
    ></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Toggle sidebar mobile
      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebar-overlay");

        if (sidebar.classList.contains("show")) {
          sidebar.classList.remove("show");
          overlay.style.display = "none";
        } else {
          sidebar.classList.add("show");
          overlay.style.display = "block";
        }
      }

      // Marcar link ativo
      document.addEventListener("DOMContentLoaded", function () {
        const currentPath = window.location.pathname;
        const navLinks = document.querySelectorAll(".nav-link");

        navLinks.forEach((link) => {
          if (link.getAttribute("href") === currentPath) {
            link.classList.add("active");
          }
        });

        // Animação de entrada dos cards otimizada
        const cards = document.querySelectorAll(".card");
        
        // Usar requestAnimationFrame para melhor performance
        requestAnimationFrame(() => {
          cards.forEach((card, index) => {
            // Limitar a 6 cards animados simultaneamente para evitar overhead
            if (index < 6) {
              card.style.animationDelay = `${index * 0.05}s`;
              card.classList.add("animate-fade-in");
              
              // Remover will-change após animação
              card.addEventListener('animationend', function() {
                this.classList.add('animation-complete');
              }, { once: true });
            } else {
              // Cards extras aparecem sem animação
              card.style.opacity = '1';
            }
          });
        });
      });

      // Fechar sidebar ao clicar em link (mobile)
      document.querySelectorAll(".nav-link").forEach((link) => {
        link.addEventListener("click", () => {
          if (window.innerWidth < 768) {
            toggleSidebar();
          }
        });
      });

      // Auto-dismiss alerts
      setTimeout(() => {
        const alerts = document.querySelectorAll(".alert");
        alerts.forEach((alert) => {
          const bsAlert = new bootstrap.Alert(alert);
          setTimeout(() => {
            if (alert.parentNode) {
              bsAlert.close();
            }
          }, 5000);
        });
      }, 1000);
    </script>
    {% block scripts %}{% endblock %}
  </body>
</html>
